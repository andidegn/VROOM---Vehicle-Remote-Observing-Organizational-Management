<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>VROOM: Private</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="VROOM Logo.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">VROOM
   &#160;<span id="projectnumber">v0.01</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('group__spi__priv.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#groups">Modules</a> &#124;
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">Private<div class="ingroups"><a class="el" href="group__spi.html">SPI Driver</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="groups"></a>
Modules</h2></td></tr>
<tr class="memitem:group__spi__ports"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__spi__ports.html">SPI Ports</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:group__spi__max__handles"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__spi__max__handles.html">SPI max handles</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:group__spi__level"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__spi__level.html">SPI Active Level</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structhandle__param.html">handle_param</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">struct containing the setup parameters for a single SPI setup  <a href="structhandle__param.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:gaf59453d74cf6184e7dcf81f5fecf8c99"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__spi__priv.html#gaf59453d74cf6184e7dcf81f5fecf8c99">_setup_spi</a> (<a class="el" href="structhandle__param.html">handle_param</a> *__param)</td></tr>
<tr class="memdesc:gaf59453d74cf6184e7dcf81f5fecf8c99"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets up the ports for the spi bus.  <a href="#gaf59453d74cf6184e7dcf81f5fecf8c99">More...</a><br/></td></tr>
<tr class="separator:gaf59453d74cf6184e7dcf81f5fecf8c99"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga7387116c3b29a025581ec0b289d7aaa0"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__spi__priv.html#ga7387116c3b29a025581ec0b289d7aaa0">_set_cs_level</a> (uint8_t __level)</td></tr>
<tr class="memdesc:ga7387116c3b29a025581ec0b289d7aaa0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets the CS/CE level based on the level.  <a href="#ga7387116c3b29a025581ec0b289d7aaa0">More...</a><br/></td></tr>
<tr class="separator:ga7387116c3b29a025581ec0b289d7aaa0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gabddcb9317f7bc6255e6811eec522efaf"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__spi__priv.html#gabddcb9317f7bc6255e6811eec522efaf">_send</a> (uint8_t __data)</td></tr>
<tr class="memdesc:gabddcb9317f7bc6255e6811eec522efaf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sends up data Sets up the SPI with 'handle' if it is not already the current handle. Then sends the data and returns '1'. If the SPI driver is busy performing another task, the data is not sent and a '0' is returned.  <a href="#gabddcb9317f7bc6255e6811eec522efaf">More...</a><br/></td></tr>
<tr class="separator:gabddcb9317f7bc6255e6811eec522efaf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga3c0688f495ba212b5ec3cc36019d6484"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__spi__priv.html#ga3c0688f495ba212b5ec3cc36019d6484">ISR</a> (SPI_STC_vect, ISR_BLOCK)</td></tr>
<tr class="memdesc:ga3c0688f495ba212b5ec3cc36019d6484"><td class="mdescLeft">&#160;</td><td class="mdescRight">Interrupt service routine Interrupt service routine for the SPI. If a callback function pointer is supplied when setting up the SPI, a callback to that function is being performed. Else the SPI is released.  <a href="#ga3c0688f495ba212b5ec3cc36019d6484">More...</a><br/></td></tr>
<tr class="separator:ga3c0688f495ba212b5ec3cc36019d6484"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="gabddcb9317f7bc6255e6811eec522efaf"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void _send </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>__data</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Sends up data Sets up the SPI with 'handle' if it is not already the current handle. Then sends the data and returns '1'. If the SPI driver is busy performing another task, the data is not sent and a '0' is returned. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">uint8_t</td><td>__data - the data to be sent</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>void </dd></dl>

<p>Definition at line <a class="el" href="spi_8c_source.html#l00258">258</a> of file <a class="el" href="spi_8c_source.html">spi.c</a>.</p>

</div>
</div>
<a class="anchor" id="ga7387116c3b29a025581ec0b289d7aaa0"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void _set_cs_level </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>__level</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Sets the CS/CE level based on the level. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">uint8_t</td><td>__level - CS_ACTIVE or CS_INACTIVE</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>void </dd></dl>

<p>Definition at line <a class="el" href="spi_8c_source.html#l00235">235</a> of file <a class="el" href="spi_8c_source.html">spi.c</a>.</p>

</div>
</div>
<a class="anchor" id="gaf59453d74cf6184e7dcf81f5fecf8c99"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void _setup_spi </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structhandle__param.html">handle_param</a> *&#160;</td>
          <td class="paramname"><em>__param</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Sets up the ports for the spi bus. </p>
<ul>
<li>Sets up the SPI ports as output</li>
<li>Clears the SPRC register before setup to make sure it is clear</li>
<li>Sets up the SPRC register based on the supplied parameters<ul>
<li>SPIE, SPE and master are fixed</li>
</ul>
</li>
<li>Sets up the SPSR register if divider 2, 8 or 32 is chosen</li>
</ul>
<table class="doxtable">
<tr>
<th align="left">SPI mode: </th><th align="center">CPOL </th><th align="center">CHAP  </th></tr>
<tr>
<td align="left">SPI_MODE0 </td><td align="center">0 </td><td align="center">0 </td></tr>
<tr>
<td align="left">SPI_MODE1 </td><td align="center">0 </td><td align="center">1 </td></tr>
<tr>
<td align="left">SPI_MODE2 </td><td align="center">1 </td><td align="center">0 </td></tr>
<tr>
<td align="left">SPI_MODE3 </td><td align="center">1 </td><td align="center">1 </td></tr>
</table>
<p><br/>
</p>
<table class="doxtable">
<tr>
<th align="left">Data direction: </th><th align="center">DORD  </th></tr>
<tr>
<td align="left">SPI_MSB_FIRST </td><td align="center">0 </td></tr>
<tr>
<td align="left">SPI_LSB_FIRST </td><td align="center">1 </td></tr>
</table>
<p><br/>
</p>
<table class="doxtable">
<tr>
<th align="left">Frequency divider: </th><th align="center">SPI2X </th><th align="center">SPR1 </th><th align="center">SPR0  </th></tr>
<tr>
<td align="left">SPI_DIVIDER_2 </td><td align="center">1 </td><td align="center">0 </td><td align="center">0 </td></tr>
<tr>
<td align="left">SPI_DIVIDER_4 </td><td align="center">0 </td><td align="center">0 </td><td align="center">0 </td></tr>
<tr>
<td align="left">SPI_DIVIDER_8 </td><td align="center">1 </td><td align="center">0 </td><td align="center">1 </td></tr>
<tr>
<td align="left">SPI_DIVIDER_16 </td><td align="center">0 </td><td align="center">0 </td><td align="center">1 </td></tr>
<tr>
<td align="left">SPI_DIVIDER_32 </td><td align="center">1 </td><td align="center">1 </td><td align="center">0 </td></tr>
<tr>
<td align="left">SPI_DIVIDER_64 </td><td align="center">0 </td><td align="center">1 </td><td align="center">0 </td></tr>
<tr>
<td align="left">SPI_DIVIDER_128 </td><td align="center">0 </td><td align="center">1 </td><td align="center">1 </td></tr>
</table>
<p>Enables SPI, sets it as Master and sets all related bits (p.202) </p>
<table class="doxtable">
<tr>
<th align="left">Bit </th><th align="center">7 </th><th align="center">6 </th><th align="center">5 </th><th align="center">4 </th><th align="center">3 </th><th align="center">2 </th><th align="center">1 </th><th align="center">0 </th><th align="center"></th></tr>
<tr>
<td align="left">0x2C (0x4C) </td><td align="center">SPIE</td><td align="center">SPE</td><td align="center">DORD</td><td align="center">MSTR</td><td align="center">CPOL</td><td align="center">CPHA</td><td align="center">SPR1</td><td align="center">SPR0</td><td align="center">SPCR </td></tr>
<tr>
<td align="left">Direction </td><td align="center">R/W</td><td align="center">R/W</td><td align="center">R/W</td><td align="center">R/W</td><td align="center">R/W</td><td align="center">R/W</td><td align="center">R/W</td><td align="center">R/W</td><td align="center"></td></tr>
</table>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname"><a class="el" href="structhandle__param.html" title="struct containing the setup parameters for a single SPI setup ">handle_param</a></td><td>*__param - a struct containing the parameters for the SPI setup</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>void </dd></dl>

<p>Definition at line <a class="el" href="spi_8c_source.html#l00196">196</a> of file <a class="el" href="spi_8c_source.html">spi.c</a>.</p>

</div>
</div>
<a class="anchor" id="ga3c0688f495ba212b5ec3cc36019d6484"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ISR </td>
          <td>(</td>
          <td class="paramtype">SPI_STC_vect&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ISR_BLOCK&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Interrupt service routine Interrupt service routine for the SPI. If a callback function pointer is supplied when setting up the SPI, a callback to that function is being performed. Else the SPI is released. </p>

<p>Definition at line <a class="el" href="spi_8c_source.html#l00271">271</a> of file <a class="el" href="spi_8c_source.html">spi.c</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Wed Dec 3 2014 06:37:20 for VROOM by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.6 </li>
  </ul>
</div>
</body>
</html>
